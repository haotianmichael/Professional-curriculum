# 数据的共享和保护

### 1. 标识符的作用域和可见性

作用域的分类:

* 函数原型作用域
* 局部作用域（快作用域）
* 类作用域
* 文件作用域（静态作用域）
* 命名空间作用域

可见性

* 从标识符的引用角度来考虑的
* 可见性表示从内层作用域向外层作用域“看”时能看见什么
* **如果标识符在某处可见，就可以在该处引用该标识符**

**如果在外层定义了一个标识符A，但是在内层有一个标识符A与之同名，那A在内层就是不可见的。**



### 2.对象的生存期



从对象的诞生开始，到对象结束的这一段时间

* 静态生存期  

> 和程序的运行期是一致的。  函数内部的static对象
>
> **在静态生存期中的变量和对象的值是一直存储着的，不会无缘无故的改变。**

* 动态生存期

> 开始于程序执行到声明点时，结束于命名该标识符的作用域结束的的地方。



### 3.类的静态成员

**类的静态数据成员**

* 用static修饰   为该类的所有对象共有， 具有静态生存期
* **声明是在类内的，但是必须在类外进行定义和初始化，用（::）来指明所属的类**

**类的静态函数成员**

>  使用静态函数成员来处理静态数据成员;   不能处理特定对象的数据成员。

* 既可以通过类名调用静态函数成员，也可以通过对象名调用静态函数成员



### 4. 类的友元

* 友元是C++提供的一种破坏数据封装和数据隐藏的机制
* 通过将一个模块声明为另一个模块的友元，**一个模块能够引用到另一个模块中本来隐藏的信息**
* 可以声明**友元函数**和**友元类**    
* 为了确保数据的完整性，及数据封装与隐藏的原则，建议慎用友元
* **友元关系是单向的**





### 5.共享数据的保护

对于一些共享的数据，要保证其不能被修改。**可以定义为常类型**

有一些类的成员函数不会改变对象的状态，**称为常函数**

**常类型**

* 常对象    必须进行初始化，不能被更新

  > const 类名   对象名

* 常成员

  > 用const 进行修饰的类成员： 常数据成员和和常函数成员
  >
  > Void printf() const{};

* 常引用

  > 被引用的对象不能被更新
  >
  > const 类型说明符   &引用名称

* 常数组

  > 数组元素不能被更新
  >
  > 类型说明符  const  数组名称[大小]

* 常指针

  > 指向常量的指针



### 6.多文件结构和预编译

**标准C++类**

>  是一个极为灵活并可扩展的可重用软件模块的集合。
>
> 标准C++类与组件在逻辑上分为6中类型:
>
> * 输出/输出类
> * 容器类与抽象数据类型
> * 存储管理类
> * 算法
> * 错误处理
> * 运行环境支持



**外部变量**

> 除了在定义它的源文件中可以使用之外，还能被其他文件使用。
>
> 文件作用域中定义的变量，默认情况下都是外部变量。
>
> 在其他文件中如果需要使用，需要使用extern关键字声明。



**外部函数**

> 在所有 类之外声明的函数（也就是非成员函数）都是具有文件作用域的
>
> 这样的函数都可以在不同的编译单元中被调用
>
> **只要在调用之前进行引用性声明（即声明函数原型）即可**



**将变量和函数限制在编译单元中**

> 在匿名命名空间中定义的变量和函数，都不会暴露给其他的编译单元
>
> Namespace {
>
> int n;
>
> void f() {n++;}
>
> }

**编译预处理**

> **#define **
>
> 定义符号常量： 很多情况下已经被const定义语句取代
>
> 定义带参数宏，已被内联函数取代

